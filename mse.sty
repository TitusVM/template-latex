\NeedsTeXFormat{LaTeX2e}
\def\Presentation@Version{1.0}
\ProvidesPackage{mse}[2013/03/07 MSE Template LaTex, \Presentation@Version]

\DeclareOption{semester}{\gdef\@type{Projet de Semestre}}
\DeclareOption{master}{\gdef\@type{Thèse de Master}}

\newif\ifconfidential
\DeclareOption{confidential}{\global\confidentialtrue}

\ProcessOptions

\RequirePackage[T1]{fontenc}
\RequirePackage[utf8]{inputenc}
\RequirePackage[frenchb]{babel}
\RequirePackage{float}
\RequirePackage{fancyhdr}
\RequirePackage{hyperref}
\RequirePackage{multicol}
\RequirePackage[a4paper]{geometry}
\RequirePackage{anysize}
\RequirePackage{xspace}

\newcommand{\@email}{}
\newcommand{\email}[1]{\gdef\@email{#1}}
\newcommand{\@institute}{}
\newcommand{\@institutename}{}
\newcommand{\institute}[2]{\gdef\@institutename{#1}\gdef\@institute{#2}}
\newcommand{\@professor}{}
\newcommand{\@professoremail}{}
\newcommand{\@professorinstitute}{}
\newcommand{\professor}[3]{\gdef\@professor{#1}\gdef\@professoremail{#2}\gdef\@professorinstitute{#3}}
\newcommand{\@supervisor}{}
\newcommand{\@supervisoremail}{}
\newcommand{\@supervisorinstitute}{}
\newcommand{\supervisor}[3]{\gdef\@supervisor{#1}\gdef\@supervisoremail{#2}\gdef\@supervisorinstitute{#3}}
\newcommand{\@expert}{}
\newcommand{\@expertemail}{}
\newcommand{\@expertinstitute}{}
\newcommand{\expert}[3]{\gdef\@expert{#1}\gdef\@expertemail{#2}\gdef\@expertinstitute{#3}}
\newcommand{\@proposedby}{}
\newcommand{\@proposedbymail}{}
\newcommand{\@proposedbyinstitute}{}
\newcommand{\proposedby}[3]{\gdef\@proposedby{#1}\gdef\@proposedbyemail{#2}\gdef\@proposedbyinstitute{#3}}
\newcommand{\@advisor}{}
\newcommand{\advisor}[1]{\gdef\@advisor{#1}}
\newcommand{\@head}{}
\newcommand{\head}[1]{\gdef\@head{#1}}
 
\renewcommand{\maketitle}{

   \pagestyle{empty}

   \begin{center}
      \parbox[c][\textheight][t]{1.0\textwidth}{
         \begin{center}

         \vspace*{-2cm}
         \begin{minipage}[c]{0.4\textwidth}
            \begin{flushleft}
               \includegraphics[width=200px]{gfx/mse.eps}
            \end{flushleft}
         \end{minipage}
         \hfill
         \begin{minipage}[c]{0.4\textwidth}
            \begin{flushright}
               \includegraphics[width=150px]{gfx/hesso.eps}
            \end{flushright}
         \end{minipage}
         \vspace*{1.5cm}

         \ifconfidential CONFIDENTIEL \fi
         \vspace*{1.5cm}

         {\large \bf Master of Science HES-SO in Engineering}\\[1.5ex]
         {Orientation: Technologies de l'information et de la communication}
         \vspace{1.5cm}

         {\Huge \bf \@title \par}
         \vspace{2ex} 
         {\large \@type}
         \vspace{0.75cm} 

         \begin{minipage}[c]{0.6\textwidth}
            \centering Soutenu par \textit \@institutename, \textit \@institute
         \end{minipage}
         \vspace{2cm}

         {\large \@author}\\
         \if\@email \else \texttt \@email \fi
         \vspace{2.5cm} 

         \begin{minipage}[t]{0.49\textwidth}
            \begin{flushleft}
               {\bf Professeur}\\
               \@professor, {\textit \@professorinstitute}\\
               {\texttt \@professoremail}\\
               \vspace{1cm} 
               {\bf Superviseur}\\
               \@supervisor, {\textit \@supervisorinstitute}\\
               {\texttt \@supervisoremail}
            \end{flushleft}
         \end{minipage}
         \hfill
         \begin{minipage}[t]{0.49\textwidth}
            \begin{flushright}
               {\bf Expert}\\
               \@expert, {\textit \@expertinstitute}\\
               {\texttt \@expertemail}
            \end{flushright}
         \end{minipage}

         \vfill
         {HES-SO//Master, \@date}

         \end{center}
      }
   \end{center}
   \cleardoublepage
}

\newcommand{\makextrainfo}{

   \pagestyle{empty}

   \begin{center}
      \parbox[c][\textheight][t]{1.0\textwidth}{
         \begin{center}

            Accepté par la HES SO//Master (Suisse, Lausanne) sur proposition de\\[2ex]
            \@proposedby, {\textit \@proposedbyinstitute}\\
            {\texttt \@proposedbyemail}
            \vspace{2.5cm} 

            \begin{minipage}[t]{0.49\textwidth}
               \begin{flushleft}
                  {\bf Conseiller}\\
                  \@advisor\\
               \end{flushleft}
            \end{minipage}
            \hfill
            \begin{minipage}[t]{0.49\textwidth}
               \begin{flushright}
                  {\bf Responsable de la filière MSE}\\
                  \@head\\
               \end{flushright}
            \end{minipage}

         \end{center}
      }
   \end{center}
   \cleardoublepage
}

\let\origdoublepage\cleardoublepage
\newcommand{\clearemptydoublepage}{
   \clearpage
   {\pagestyle{empty}\origdoublepage}
}